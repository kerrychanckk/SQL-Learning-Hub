<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>Simple SQL Sandbox</title>    <script src="https://cdn.tailwindcss.com"></script>    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.10.3/sql-wasm.js"></script>    <style>        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }        .sql-editor { font-family: 'Courier New', Courier, monospace; font-size: 14px; }        #results-container th, #results-container td { white-space: nowrap; }    </style></head><body class="text-slate-800">    <!-- Main Application UI -->    <div id="app-container" class="h-screen flex flex-col">        <header class="bg-white border-b border-slate-200 p-3 flex justify-between items-center shadow-sm">            <h1 class="text-xl font-bold text-slate-800"><span class="text-sky-500">SQL</span> Sandbox for Students</h1>            <button id="reset-db-btn" class="bg-red-500 text-white font-semibold text-sm py-2 px-4 rounded-lg hover:bg-red-600 transition shadow">Reset Database</button>        </header>                <main class="flex-grow flex overflow-hidden">            <aside class="w-1/5 bg-white border-r border-slate-200 p-4 flex flex-col">                <h2 class="text-lg font-semibold mb-3 border-b pb-2">Tables in Database</h2>                <ul id="tables-list" class="space-y-2 text-sm flex-grow overflow-y-auto"></ul>            </aside>            <div class="w-4/5 flex flex-col p-4 gap-4 bg-slate-50">                <div class="flex flex-col bg-white p-4 rounded-xl shadow-sm border border-slate-200">                    <label for="sql-editor" class="text-lg font-semibold mb-2 text-slate-700">SQL Command Editor</label>                    <textarea id="sql-editor" class="sql-editor w-full h-48 p-3 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500" placeholder="-- Try this query to find top Physics students in class 4A!SELECT    s.class,    s.no,    s.first_name,    s.last_name,    e.subject,    e.scoreFROM    students sJOIN    exams e ON s.student_id = e.student_idWHERE    s.class = '4A' AND e.subject = 'Physics'ORDER BY    e.score DESC;"></textarea>                    <div class="flex items-center justify-between mt-3">                        <p class="text-xs text-slate-500">Tip: Use <kbd class="font-sans bg-slate-200 rounded px-1.5 py-0.5 border-b-2 border-slate-300">Ctrl+Enter</kbd> or <kbd class="font-sans bg-slate-200 rounded px-1.5 py-0.5 border-b-2 border-slate-300">Cmd+Enter</kbd> to run.</p>                        <div>                            <button id="save-db-btn" class="bg-emerald-500 text-white font-semibold py-2 px-5 rounded-lg hover:bg-emerald-600 shadow-sm">Save to Browser</button>                            <button id="run-sql-btn" class="bg-sky-500 text-white font-bold py-2 px-8 rounded-lg hover:bg-sky-600 shadow-sm">Run SQL</button>                        </div>                    </div>                </div>                <div class="flex-grow flex flex-col bg-white p-4 rounded-xl shadow-sm border border-slate-200 overflow-hidden">                    <h2 class="text-lg font-semibold mb-2 text-slate-700">Results</h2>                    <div id="message-area" class="mb-2 text-sm h-5"></div>                    <div id="results-container" class="flex-grow overflow-auto"></div>                </div>            </div>        </main>    </div>    <script>        // DOM Elements        const runSqlBtn = document.getElementById('run-sql-btn');        const saveDbBtn = document.getElementById('save-db-btn');        const resetDbBtn = document.getElementById('reset-db-btn');        const tablesList = document.getElementById('tables-list');        const sqlEditor = document.getElementById('sql-editor');        const messageArea = document.getElementById('message-area');        const resultsContainer = document.getElementById('results-container');                // App State        let db;        let SQL;        const dbKey = 'sql_sandbox_local_db';        // --- Database Initialization ---        async function main() {            try {                SQL = await initSqlJs({ locateFile: file => `https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.10.3/${file}` });                loadDatabase();            } catch (err) {                console.error("Failed to initialize SQL.js:", err);                displayMessage("error", "Error: Could not load database engine. Check internet and refresh.");            }        }        function loadDatabase() {            const savedDb = localStorage.getItem(dbKey);            if (savedDb) {                try {                    const dbArray = savedDb.split(',').map(Number);                    db = new SQL.Database(new Uint8Array(dbArray));                    displayMessage("success", "Loaded saved database from your browser.");                } catch (e) {                    console.error("Error loading DB from localStorage:", e);                    localStorage.removeItem(dbKey); // Clear corrupted data                    createNewDatabase();                }            } else {                createNewDatabase();            }            updateTablesList();        }                function createNewDatabase() {            db = new SQL.Database();            createSampleTables(db);            displayMessage("success", "A new database with sample tables ('students', 'exams') has been created.");        }        function createSampleTables(database) {            try {                // Drop old tables if they exist for a clean reset                database.run(`DROP TABLE IF EXISTS students;`);                database.run(`DROP TABLE IF EXISTS exams;`);                // Create new students table                database.run(`                    CREATE TABLE students (                        student_id INTEGER PRIMARY KEY,                        class TEXT,                        no INTEGER,                        last_name TEXT,                        first_name TEXT,                        gender TEXT,                        dob DATE,                        district TEXT                    );                `);                // Create new exams table                database.run(`                    CREATE TABLE exams (                        student_id INTEGER,                        subject TEXT,                        score INTEGER,                        FOREIGN KEY(student_id) REFERENCES students(student_id)                    );                `);                                // Data for generation                const lastNames = ['Chan', 'Lee', 'Wong', 'Cheung', 'Lau', 'Leung', 'Ho', 'Fung', 'Mak', 'Yip', 'Ng', 'Lam', 'Poon', 'Tang'];                const maleFirstNames = ['Ka-Chun', 'Lok-Hang', 'Chi-Kin', 'Siu-Ming', 'Wai-Ho', 'Tsz-Fung', 'Man-Hin', 'Pak-Hei', 'Chun-Kit', 'Yat-Long'];                const femaleFirstNames = ['Wing-Yan', 'Tsz-Ching', 'Hiu-Lam', 'Ka-Man', 'Pui-Sze', 'Lok-Yee', 'Sze-Wing', 'Ka-Po', 'Mei-Ling', 'Yee-Ting'];                const districts = ['Central & Western', 'Wan Chai', 'Eastern', 'Southern', 'Yau Tsim Mong', 'Sham Shui Po', 'Kowloon City', 'Wong Tai Sin', 'Kwun Tong', 'Kwai Tsing', 'Tsuen Wan', 'Tuen Mun', 'Yuen Long', 'North', 'Tai Po', 'Sha Tin', 'Sai Kung', 'Islands'];                const classes = ['4A', '4C', '4D', '5D'];                let studentInserts = [];                const studentIds = [];                const usedStudentIds = new Set();                // Generate 120 students                for (const className of classes) {                    for (let i = 1; i <= 30; i++) {                        let studentId;                        do {                            studentId = Math.floor(1000 + Math.random() * 9000);                        } while (usedStudentIds.has(studentId));                        usedStudentIds.add(studentId);                        studentIds.push(studentId);                                                const gender = Math.random() > 0.5 ? 'M' : 'F';                        const firstName = gender === 'M' ? maleFirstNames[Math.floor(Math.random() * maleFirstNames.length)] : femaleFirstNames[Math.floor(Math.random() * femaleFirstNames.length)];                        const lastName = lastNames[Math.floor(Math.random() * lastNames.length)];                        const month = String(Math.floor(Math.random() * 12) + 1).padStart(2, '0');                        const day = String(Math.floor(Math.random() * 28) + 1).padStart(2, '0');                        const dob = `2009-${month}-${day}`;                        const district = districts[Math.floor(Math.random() * districts.length)];                        studentInserts.push(`(${studentId}, '${className}', ${i}, '${lastName}', '${firstName}', '${gender}', '${dob}', '${district}')`);                    }                }                database.run(`INSERT INTO students (student_id, class, no, last_name, first_name, gender, dob, district) VALUES ${studentInserts.join(', ')};`);                                // Generate exam results for 120 students                const mandatorySubjects = ['Chinese', 'English', 'Math'];                const electiveSubjects = ['ICT', 'Physics', 'Bio', 'Econ'];                let examInserts = [];                                for (const sId of studentIds) {                    // Mandatory subjects                    mandatorySubjects.forEach(subject => {                        const score = Math.floor(Math.random() * 61) + 40; // 40-100                        examInserts.push(`(${sId}, '${subject}', ${score})`);                    });                    // Elective subjects                    const numElectives = Math.random() > 0.5 ? 3 : 2;                    const shuffledElectives = [...electiveSubjects].sort(() => 0.5 - Math.random());                    const takenElectives = shuffledElectives.slice(0, numElectives);                                        takenElectives.forEach(subject => {                        const score = Math.floor(Math.random() * 61) + 40; // 40-100                        examInserts.push(`(${sId}, '${subject}', ${score})`);                    });                }                database.run(`INSERT INTO exams (student_id, subject, score) VALUES ${examInserts.join(', ')};`);            } catch (err) {                console.error("Error creating sample tables:", err);                displayMessage("error", "Could not create the initial sample tables.");            }        }        function saveDatabase() {            if (!db) return;            try {                const data = db.export();                localStorage.setItem(dbKey, Array.from(data).toString());                displayMessage("success", "Database saved successfully to this browser.");            } catch (err) {                console.error("Error saving database:", err);                displayMessage("error", "Failed to save the database.");            }        }                function resetDatabase() {            // No confirmation for faster classroom use            localStorage.removeItem(dbKey);            createNewDatabase();            updateTablesList();        }        // --- SQL Execution & Display ---        function runSql() {            if (!db) { displayMessage("error", "Database not loaded."); return; }            const sqlCode = sqlEditor.value;            clearResults();            try {                const statements = sqlCode.split(';').filter(s => s.trim() !== '');                statements.forEach(statement => {                     const results = db.exec(statement.trim());                     results.forEach((result) => displayResultsTable(result));                });                displayMessage("success", "Query executed successfully.");                updateTablesList();            } catch (err) {                displayMessage("error", `Error: ${err.message}`);            }        }                function updateTablesList() {             if (!db) return;             tablesList.innerHTML = '';             try {                const res = db.exec("SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%';");                if (res.length > 0 && res[0].values.length > 0) {                    res[0].values.forEach(row => {                        const li = document.createElement('li');                        li.textContent = row[0];                        li.className = 'px-3 py-2 bg-slate-100 rounded-md cursor-pointer hover:bg-sky-100';                        li.onclick = () => { sqlEditor.value = `SELECT * FROM ${row[0]};`; runSql(); };                        tablesList.appendChild(li);                    });                } else {                    tablesList.innerHTML = '<li class="text-slate-500 italic">No tables found.</li>';                }             } catch (e) { console.error(e); }        }        function displayResultsTable(result) {            if (!result || (result.values.length === 0 && result.columns.length === 0)) return;            const table = document.createElement('table');            table.className = "w-full text-sm text-left text-slate-500 border-collapse mb-4";            const thead = document.createElement('thead');            thead.className = "text-xs text-slate-700 uppercase bg-slate-100";            const headerRow = document.createElement('tr');            result.columns.forEach(colName => {                const th = document.createElement('th');                th.className = "px-4 py-3 border border-slate-200";                th.textContent = colName;                headerRow.appendChild(th);});            thead.appendChild(headerRow);            table.appendChild(thead);            const tbody = document.createElement('tbody');            result.values.forEach(row => {                const tr = document.createElement('tr');                tr.className = "bg-white border-b hover:bg-slate-50";                row.forEach(cell => {                    const td = document.createElement('td');                    td.className = "px-4 py-2 border border-slate-200";                    td.textContent = cell;                    tr.appendChild(td);                });                tbody.appendChild(tr);            });            table.appendChild(tbody);            resultsContainer.appendChild(table);        }        function displayMessage(type, text) {            messageArea.textContent = text;            messageArea.className = 'mb-2 text-sm h-5 ';            switch(type) {                case "success": messageArea.classList.add('text-green-600'); break;                case "error": messageArea.classList.add('text-red-600'); break;                case "warning": messageArea.classList.add('text-amber-600'); break;            }        }        function clearResults() { resultsContainer.innerHTML = ''; messageArea.innerHTML = ''; }        // --- Event Listeners ---        runSqlBtn.addEventListener('click', runSql);        saveDbBtn.addEventListener('click', saveDatabase);        resetDbBtn.addEventListener('click', resetDatabase);        sqlEditor.addEventListener('keydown', (e) => {            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {                e.preventDefault();                runSql();            }        });        // Start the application        main();    </script></body></html>